{% extends "base.html" %}
{% block content %}
<div class="container my-5">
    <h2 class="mb-3">Matched Jobs for {{ cv.full_name }}</h2>
    <p class="text-muted mb-4">Showing top {{ top }} matches</p>

    <ul class="list-group">
        {% for r in results %}
            {% with job=r.job %}
            <li class="list-group-item mb-3 shadow-sm rounded">
                <h5><a href="{{ job.job_url }}" target="_blank" class="text-primary">{{ job.title }}</a></h5>
                <p><strong>{{ job.company }}</strong>{% if job.location %} · {{ job.location }}{% endif %}</p>

                {% if r.score is not None %}
                    <p>Match Score: {{ r.score|floatformat:2 }}%</p>
                {% elif job.match_score %}
                    <p>Match Score: {{ job.match_score|floatformat:2 }}%</p>
                {% endif %}

                {% if job.description %}
                    <details>
                        <summary>Show job description</summary>
                        <p>{{ job.description|linebreaksbr }}</p>
                    </details>
                {% endif %}

                <a href="{{ job.job_url }}" target="_blank" class="btn btn-outline-primary mt-2">Apply →</a>
            </li>
            {% endwith %}
        {% empty %}
            <li class="list-group-item text-muted">No matches found.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
